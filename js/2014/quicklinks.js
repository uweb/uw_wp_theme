"use strict";UW.QuickLinks=Backbone.View.extend({DELAY:500,settings:{},container:"#page",template:'<nav id="quicklinks" aria-label="quick links" aria-hidden="true"><ul id="big-links"><% _.each( links, function( link ) { %> <% if ( link.classes ) { %><li><span class="<%= link.classes %>"></span><a href="<%= link.url %>" tabindex="-1"><%= link.title %></a></li><% } %><% }) %></ul><h3>Helpful Links</h3><ul id="little-links"><% _.each( links, function( link ) { %> <% if ( ! link.classes ) { %><li><span class="<%= link.classes %>"></span><a href="<%= link.url %>" tabindex="-1"><%= link.title %></a></li><% } %><% }) %></ul></nav>',events:{click:"animate",touchstart:"animate",keyup:"animate",blur:"loop"},initialize:function(i){_.bindAll(this,"inner_keydown","render","renderDefault","animate","accessible","loop","transitionEnd"),this.options=_.extend({},this.settings,i),this.links=new UW.QuickLinks.Collection(this.options),this.links.on("sync",this.render),this.links.on("error",this.renderDefault),this.links.fetch()},renderDefault:function(){this.defaultLinks=this.links.defaults,this.render()},render:function(){this.defaultLinks=this.links.defaults,this.quicklinks=$(_.template(this.template)({links:this.defaultLinks?this.defaultLinks:this.links.toJSON()})),this.$container=$(this.container),this.$container.prepend(this.quicklinks),this.$el.attr("aria-controls","quicklinks").attr("aria-owns","quicklinks"),UW.$body.on("keydown","#quicklinks a:first",this.inner_keydown),UW.$body.on("keyup","#quicklinks a",this.animate),this.quicklinks.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.transitionEnd)},transitionEnd:function(i){this.open&&i.target==this.quicklinks[0]&&this.accessible()},inner_keydown:function(i){if(9==i.keyCode&&i.shiftKey)return this.$el.focus(),!1},animate:function(i){if(i.preventDefault(),i.keyCode&&27!=i.keyCode&&(i.keyCode&&13!=i.keyCode||i.keyCode&&32!=i.keyCode))return!1;this.$container.toggleClass("open"),this.quicklinks.toggleClass("open"),this.open=this.quicklinks.hasClass("open"),this.open||this.accessible()},accessible:function(i){this.$el.attr("aria-expanded",this.open),this.quicklinks.attr("aria-hidden",(!this.open).toString()),this.open?(this.$el.attr("aria-label","Close quick links"),this.quicklinks.find("a").attr("tabindex",0).first().focus(),$("#page-inner").attr("aria-hidden",!0),$(".screen-reader-shortcut").attr("aria-hidden",!0)):(this.$el.attr("aria-label","Open quick links"),this.quicklinks.find("a").attr("tabindex",-1),this.$el.focus(),$("#page-inner").attr("aria-hidden",!1),$(".screen-reader-shortcut").attr("aria-hidden",!1))},loop:function(i){this.open&&this.quicklinks.find("li a").first().focus()}}),UW.QuickLinks.Model=Backbone.Model.extend({}),UW.QuickLinks.Collection=Backbone.Collection.extend({model:UW.QuickLinks.Model,initialize:function(i){this.url=i.url},defaults:[{title:"MyUW",url:"http://my.uw.edu",classes:["icon-myuw"]},{title:"Calendar",url:"http://uw.edu/calendar",classes:["icon-calendar"]},{title:"Directories",url:"http://uw.edu/directory/",classes:["icon-directories"]},{title:"Libraries",url:"http://www.lib.washington.edu/",classes:["icon-libraries"]},{title:"UW Medicine",url:"http://www.uwmedicine.org",classes:["icon-medicine"]},{title:"Maps",url:"http://uw.edu/maps",classes:["icon-maps"]},{title:"UW Today",url:"http://uw.edu/news",classes:["icon-uwtoday"]},{title:"Computing/IT",url:"http://itconnect.uw.edu",classes:!1},{title:"Employee Self Service",url:"http://isc.uw.edu/",classes:!1},{title:"Husky Card",url:"http://hfs.uw.edu/Husky-Card-Services/",classes:!1},{title:"UW Bothell",url:"http://www.uwb.edu/",classes:!1},{title:"UW Tacoma",url:"http://www.tacoma.uw.edu/",classes:!1},{title:"UW Facebook",url:"https://www.facebook.com/UofWA",classes:!1},{title:"UW Twitter",url:"https://twitter.com/UW",classes:!1}]});